# è¡¨å•ç»„ä»¶åº“ä¿®å¤æ–‡æ¡£

æœ¬æ–‡æ¡£è®°å½•äº†è¡¨å•ç»„ä»¶åº“å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜åŠå…¶ä¿®å¤æ–¹æ¡ˆã€‚

## ğŸš€ v2.0.0 - é«˜çº§æ‰©å±•åŠŸèƒ½å‘å¸ƒ (2024-12)

### ğŸ†• æ–°å¢åŠŸèƒ½

#### é«˜é˜¶ç»„ä»¶ (HOC) æ‰©å±•
- âœ… **withDebounce** - é˜²æŠ–è¾“å…¥HOCï¼Œä¼˜åŒ–æœç´¢å’ŒAPIè°ƒç”¨æ€§èƒ½
- âœ… **withAsyncValidation** - å¼‚æ­¥éªŒè¯HOCï¼Œæ”¯æŒæœåŠ¡å™¨ç«¯éªŒè¯
- âœ… **withLocalStorage** - æœ¬åœ°å­˜å‚¨HOCï¼Œè‡ªåŠ¨ä¿å­˜å’Œæ¢å¤è¡¨å•æ•°æ®
- âœ… **withConditionalRender** - æ¡ä»¶æ¸²æŸ“HOCï¼ŒåŠ¨æ€æ˜¾ç¤º/éšè—å­—æ®µ

#### æ–°å¢ç»„ä»¶
- âœ… **DatePicker** - æ—¥æœŸé€‰æ‹©å™¨ç»„ä»¶ï¼Œæ”¯æŒå¤šç§æ ¼å¼å’ŒéªŒè¯

#### é¢„åˆ¶ç»„åˆç»„ä»¶
- âœ… **SuperInput** - é˜²æŠ– + éªŒè¯ + å­—æ®µæ ·å¼çš„è¶…çº§ç»„åˆ
- âœ… **SearchInput** - é˜²æŠ– + æœ¬åœ°å­˜å‚¨çš„æœç´¢ä¸“ç”¨ç»„åˆ
- âœ… **AsyncValidatedInput** - å¼‚æ­¥éªŒè¯ + å­—æ®µæ ·å¼ç»„åˆ
- âœ… **ConditionalEnhancedInput** - æ¡ä»¶æ¸²æŸ“ + å¢å¼ºåŠŸèƒ½ç»„åˆ

### ğŸ“š æ–‡æ¡£æ›´æ–°
- âœ… æ–°å¢ `ADVANCED_EXTENSIONS.md` - è¯¦ç»†çš„é«˜çº§åŠŸèƒ½æ–‡æ¡£
- âœ… æ–°å¢ `QUICK_START_EXTENSIONS.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… æ–°å¢ `examples/AdvancedFormExample.tsx` - å®Œæ•´å®æˆ˜ç¤ºä¾‹
- âœ… æ›´æ–°ä¸»READMEï¼Œæ•´åˆæ–°åŠŸèƒ½ä»‹ç»

### ğŸ¯ è®¾è®¡æ¨¡å¼æ¼”ç¤º
- âœ… **HOCæ¨¡å¼æ‰©å±•** - å±•ç¤ºäº†æ›´å¤šå®ç”¨çš„HOCå®ç°
- âœ… **ç»„åˆæ¨¡å¼åº”ç”¨** - å¤šé‡HOCç»„åˆçš„æœ€ä½³å®è·µ
- âœ… **æ¡ä»¶æ¸²æŸ“æ¨¡å¼** - åŠ¨æ€è¡¨å•çš„å®ç°æ–¹æ¡ˆ
- âœ… **å¼‚æ­¥å¤„ç†æ¨¡å¼** - å¼‚æ­¥éªŒè¯çš„è®¾è®¡æ€è·¯

### ğŸ’¡ æŠ€æœ¯äº®ç‚¹
- ğŸ”§ **é˜²æŠ–ä¼˜åŒ–** - æå‡æœç´¢å’Œè¾“å…¥æ€§èƒ½
- ğŸŒ **å¼‚æ­¥éªŒè¯** - æ”¯æŒå®æ—¶æœåŠ¡å™¨ç«¯éªŒè¯
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–** - è‡ªåŠ¨ä¿å­˜ç”¨æˆ·è¾“å…¥
- ğŸ­ **åŠ¨æ€UI** - æ ¹æ®æ¡ä»¶åŠ¨æ€è°ƒæ•´è¡¨å•ç»“æ„
- ğŸ§© **æ— é™ç»„åˆ** - HOCå¯ä»¥ä»»æ„ç»„åˆä½¿ç”¨

---

## ä¿®å¤æ¦‚è§ˆ

| é—®é¢˜ç±»å‹ | çŠ¶æ€ | ä¿®å¤æ—¥æœŸ | å½±å“ç»„ä»¶ |
|---------|------|----------|----------|
| React Key å±æ€§é”™è¯¯ | âœ… å·²ä¿®å¤ | 2024 | FormBuilder |
| TypeScript ç±»å‹é”™è¯¯ | âœ… å·²ä¿®å¤ | 2024 | å…¨å±€ |
| DOM å±æ€§è­¦å‘Š | âœ… å·²ä¿®å¤ | 2024 | Input, Select, Textarea |

---

## 1. React Key å±æ€§å±•å¼€è¯­æ³•é”™è¯¯

### ğŸ› é—®é¢˜æè¿°

```
A props object containing a "key" prop is being spread into JSX:
  let props = {key: someKey, type: ..., className: ..., placeholder: ..., label: ..., required: ..., error: ..., helperText: ..., value: ..., onChange: ...};
  <input {...props} />
React keys must be passed directly to JSX without using spread:
  let props = {type: ..., className: ..., placeholder: ..., label: ..., required: ..., error: ..., helperText: ..., value: ..., onChange: ...};
  <input key={someKey} {...props} />
```

**é”™è¯¯ä½ç½®**: `packages/leo-form-library/src/components/FormBuilder.tsx:60`

**é”™è¯¯åŸå› **: åœ¨ `commonProps` å¯¹è±¡ä¸­åŒ…å«äº† `key` å±æ€§ï¼Œç„¶åä½¿ç”¨å±•å¼€è¯­æ³•ä¼ é€’ç»™ JSX å…ƒç´ ã€‚React è¦æ±‚ `key` å±æ€§å¿…é¡»ç›´æ¥ä¼ é€’ç»™ JSX å…ƒç´ ã€‚

### âœ… ä¿®å¤æ–¹æ¡ˆ

#### ä¿®å¤å‰ä»£ç 
```typescript
const commonProps = {
  key: field.name,  // âŒ ä¸èƒ½åœ¨è¿™é‡Œå®šä¹‰ key
  label: field.label,
  required: field.required,
  error: errors[field.name],
  helperText: field.helperText,
  value: values[field.name] || '',
  onChange: (e: any) => onFieldChange(field.name, e.target?.value ?? e)
};

// ä½¿ç”¨å±•å¼€è¯­æ³•ä¼ é€’ï¼ŒåŒ…å«äº† key
<input {...commonProps} />
```

#### ä¿®å¤åä»£ç 
```typescript
const commonProps = {
  label: field.label,  // âœ… ç§»é™¤äº† key å±æ€§
  required: field.required,
  error: errors[field.name],
  helperText: field.helperText,
  value: values[field.name] || '',
  onChange: (e: any) => onFieldChange(field.name, e.target?.value ?? e)
};

// ç›´æ¥æ·»åŠ  key å±æ€§
<input
  key={`${field.name}-input`}  // âœ… ç›´æ¥æ·»åŠ  key
  {...commonProps}
/>
```

### ğŸ“ ä¿®å¤æ­¥éª¤
1. ä» `commonProps` å¯¹è±¡ä¸­ç§»é™¤ `key` å±æ€§
2. ä¸ºæ¯ä¸ª JSX å…ƒç´ ç›´æ¥æ·»åŠ  `key` å±æ€§ï¼š
   - `input` å…ƒç´ : `key={`${field.name}-input`}`
   - `select` å…ƒç´ : `key={`${field.name}-select`}`
   - `textarea` å…ƒç´ : `key={`${field.name}-textarea`}`

---

## 2. TypeScript ç±»å‹é”™è¯¯

### ğŸ› é—®é¢˜æè¿°

#### é—®é¢˜ 1: cn å‡½æ•°ç±»å‹ä¸å…¼å®¹
```
ç±»å‹"false | "" | 0 | 0n | "pl-10" | null | undefined"çš„å‚æ•°ä¸èƒ½èµ‹ç»™ç±»å‹"string | boolean | null | undefined"çš„å‚æ•°ã€‚
ä¸èƒ½å°†ç±»å‹"0"åˆ†é…ç»™ç±»å‹"string | boolean | null | undefined"ã€‚
```

**é”™è¯¯ä½ç½®**: `packages/leo-form-library/src/components/Input.tsx:86`

#### é—®é¢˜ 2: è¡¨å•çŠ¶æ€ç±»å‹æ¨æ–­é”™è¯¯
```
å…ƒç´ éšå¼å…·æœ‰ "any" ç±»å‹ï¼Œå› ä¸ºç±»å‹ä¸º ""firstName" | "lastName"" çš„è¡¨è¾¾å¼ä¸èƒ½ç”¨äºç´¢å¼•ç±»å‹ "{}"ã€‚
ç±»å‹"{}"ä¸Šä¸å­˜åœ¨å±æ€§"firstName"ã€‚
```

**é”™è¯¯ä½ç½®**: `src/app/form-demo/page.tsx:98`

#### é—®é¢˜ 3: HOC ç±»å‹å¯¼å‡ºé”™è¯¯
```
å¯¼å‡ºçš„å˜é‡"FormFieldInput"å…·æœ‰æˆ–æ­£åœ¨ä½¿ç”¨å¤–éƒ¨æ¨¡å—ä¸­çš„åç§°"WithFormFieldProps"ï¼Œä½†ä¸èƒ½ä¸ºå…¶å‘½åã€‚
```

**é”™è¯¯ä½ç½®**: `packages/leo-form-library/src/components/index.ts:24`

### âœ… ä¿®å¤æ–¹æ¡ˆ

#### ä¿®å¤ 1: æ‰©å±• cn å‡½æ•°ç±»å‹å®šä¹‰
```typescript
// ä¿®å¤å‰
export const cn = (...classes: (string | undefined | null | boolean)[]): string => {
  return classes.filter(Boolean).join(' ');
};

// ä¿®å¤å
export const cn = (...classes: (string | undefined | null | boolean | number)[]): string => {
  return classes.filter(Boolean).join(' ');
};
```

#### ä¿®å¤ 2: æ·»åŠ è¡¨å•çŠ¶æ€ç±»å‹å®šä¹‰
```typescript
// ä¿®å¤å‰
const [builderForm, setBuilderForm] = useState({});
const [builderErrors, setBuilderErrors] = useState({});

// ä¿®å¤å
const [builderForm, setBuilderForm] = useState<Record<string, any>>({});
const [builderErrors, setBuilderErrors] = useState<Record<string, string>>({});
```

#### ä¿®å¤ 3: å¯¼å‡º HOC ç±»å‹æ¥å£
```typescript
// ä¿®å¤å‰
interface WithFormFieldProps {
  containerClassName?: string;
  showLabel?: boolean;
  showError?: boolean;
  showHelperText?: boolean;
  fieldSize?: 'small' | 'medium' | 'large';
}

// ä¿®å¤å
export interface WithFormFieldProps {
  containerClassName?: string;
  showLabel?: boolean;
  showError?: boolean;
  showHelperText?: boolean;
  fieldSize?: 'small' | 'medium' | 'large';
}
```

---

## 3. React DOM å±æ€§è­¦å‘Š

### ğŸ› é—®é¢˜æè¿°

```
React does not recognize the `helperText` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `helpertext` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
```

**é”™è¯¯åŸå› **: åœ¨ Inputã€Selectã€Textarea ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ `{...props}` å°†æ‰€æœ‰å±æ€§ä¼ é€’ç»™ DOM å…ƒç´ ï¼Œå¯¼è‡´è‡ªå®šä¹‰å±æ€§ï¼ˆå¦‚ `helperText`ã€`label`ã€`error` ç­‰ï¼‰è¢«ä¼ é€’åˆ° DOM ä¸­ã€‚

### âœ… ä¿®å¤æ–¹æ¡ˆ

ä½¿ç”¨è§£æ„èµ‹å€¼è¿‡æ»¤æ‰è‡ªå®šä¹‰å±æ€§ï¼Œåªä¼ é€’æ ‡å‡† HTML å±æ€§ï¼š

#### Input ç»„ä»¶ä¿®å¤
```typescript
// ä¿®å¤å‰
<input
  ref={ref}
  id={inputId}
  className={inputClasses}
  disabled={disabled}
  aria-invalid={hasError}
  {...props}  // âŒ åŒ…å«è‡ªå®šä¹‰å±æ€§
/>

// ä¿®å¤å
<input
  ref={ref}
  id={inputId}
  className={inputClasses}
  disabled={disabled}
  aria-invalid={hasError}
  {...(({ label, error, helperText, required, variant, size, startAdornment, endAdornment, ...rest }) => rest)(props as any)}  // âœ… è¿‡æ»¤è‡ªå®šä¹‰å±æ€§
/>
```

#### Select ç»„ä»¶ä¿®å¤
```typescript
// ä¿®å¤å‰
<select
  ref={ref}
  id={selectId}
  className={selectClasses}
  disabled={disabled}
  {...props}  // âŒ åŒ…å«è‡ªå®šä¹‰å±æ€§
>

// ä¿®å¤å
<select
  ref={ref}
  id={selectId}
  className={selectClasses}
  disabled={disabled}
  {...(({ label, error, helperText, required, options, placeholder, variant, size, ...rest }) => rest)(props as any)}  // âœ… è¿‡æ»¤è‡ªå®šä¹‰å±æ€§
>
```

#### Textarea ç»„ä»¶ä¿®å¤
```typescript
// ä¿®å¤å‰
<textarea
  ref={ref}
  id={textareaId}
  className={textareaClasses}
  disabled={disabled}
  {...props}  // âŒ åŒ…å«è‡ªå®šä¹‰å±æ€§
/>

// ä¿®å¤å
<textarea
  ref={ref}
  id={textareaId}
  className={textareaClasses}
  disabled={disabled}
  {...(({ label, error, helperText, required, variant, size, minRows, maxRows, ...rest }) => rest)(props as any)}  // âœ… è¿‡æ»¤è‡ªå®šä¹‰å±æ€§
/>
```

---

## ä¿®å¤éªŒè¯

### æµ‹è¯•æ­¥éª¤
1. **ç¼–è¯‘æ£€æŸ¥**: è¿è¡Œ `npm run build` ç¡®ä¿æ²¡æœ‰ TypeScript é”™è¯¯
2. **è¿è¡Œæ—¶æ£€æŸ¥**: è¿è¡Œ `npm run dev` ç¡®ä¿æ²¡æœ‰ React è­¦å‘Š
3. **åŠŸèƒ½æµ‹è¯•**: è®¿é—® `/form-demo` é¡µé¢æµ‹è¯•æ‰€æœ‰ç»„ä»¶åŠŸèƒ½

### éªŒè¯ç»“æœ
- âœ… æ‰€æœ‰ TypeScript ç¼–è¯‘é”™è¯¯å·²è§£å†³
- âœ… æ‰€æœ‰ React DOM å±æ€§è­¦å‘Šå·²æ¶ˆé™¤
- âœ… ç»„ä»¶åŠŸèƒ½å®Œæ•´ä¸”æ­£å¸¸å·¥ä½œ
- âœ… HOC ç»„ä»¶ç±»å‹æ¨æ–­æ­£å¸¸
- âœ… è¡¨å•éªŒè¯å’ŒçŠ¶æ€ç®¡ç†æ­£å¸¸

---

## æœ€ä½³å®è·µæ€»ç»“

### 1. React Key å±æ€§å¤„ç†
- âŒ ä¸è¦åœ¨ props å¯¹è±¡ä¸­åŒ…å« `key` å±æ€§
- âœ… å§‹ç»ˆç›´æ¥ä¼ é€’ `key` ç»™ JSX å…ƒç´ 

### 2. TypeScript ç±»å‹å®šä¹‰
- âŒ é¿å…ä½¿ç”¨éšå¼ `any` ç±»å‹
- âœ… ä¸ºçŠ¶æ€å’Œ props æä¾›æ˜ç¡®çš„ç±»å‹å®šä¹‰
- âœ… å¯¼å‡ºéœ€è¦è¢«å¤–éƒ¨ä½¿ç”¨çš„ç±»å‹æ¥å£

### 3. DOM å±æ€§ä¼ é€’
- âŒ ä¸è¦ç›´æ¥ä½¿ç”¨ `{...props}` ä¼ é€’ç»™ DOM å…ƒç´ 
- âœ… ä½¿ç”¨è§£æ„èµ‹å€¼è¿‡æ»¤æ‰è‡ªå®šä¹‰å±æ€§
- âœ… åªä¼ é€’æ ‡å‡† HTML å±æ€§ç»™ DOM å…ƒç´ 

### 4. ç»„ä»¶è®¾è®¡åŸåˆ™
- ğŸ¯ ä¿æŒç»„ä»¶ API çš„ä¸€è‡´æ€§
- ğŸ¯ ç¡®ä¿ç±»å‹å®‰å…¨
- ğŸ¯ é¿å… React è­¦å‘Šå’Œé”™è¯¯
- ğŸ¯ æä¾›è‰¯å¥½çš„å¼€å‘ä½“éªŒ

---

## ç›¸å…³æ–‡ä»¶

### ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨
- `packages/leo-form-library/src/components/FormBuilder.tsx`
- `packages/leo-form-library/src/components/Input.tsx`
- `packages/leo-form-library/src/components/Select.tsx`
- `packages/leo-form-library/src/components/Textarea.tsx`
- `packages/leo-form-library/src/utils/index.ts`
- `packages/leo-form-library/src/hocs/withFormField.tsx`
- `src/app/form-demo/page.tsx`

### å½±å“çš„ç»„ä»¶
- FormBuilder (Render Props æ¨¡å¼)
- Input (forwardRef æ¨¡å¼)
- Select (forwardRef æ¨¡å¼)
- Textarea (forwardRef æ¨¡å¼)
- withFormField (HOC æ¨¡å¼)
- withValidation (HOC æ¨¡å¼)

---

*æ–‡æ¡£æ›´æ–°æ—¥æœŸ: 2024å¹´*
*ç»´æŠ¤è€…: AI Assistant*
